# Servlets API

**Java Servlet API** — стандартизований API для створення динамічного контенту до веб-сервера, використовуючи платформу Java. Сервлети — аналог технологій PHP, CGI і ASP.NET.

У двох словах описати роботу сервлету можна так: Web-сервер, який вміє працювати з сервлетами, запускає Java-машину, яка в свою чергу виконує сервлет, а сервлет віддає дані, які він сформує. Тобто при приході запиту від клієнта сервер за допомогою спеціального конфігураційного файлу може визначити, який сервлет виконати, сервлет виконується і створює HTML-сторінку, яку сервер відправляє клієнту.

# Web Container

Контейнер сервлетов - програма, що представляє собою сервер, який займається системною підтримкою сервлетов і забезпечує їх життєвий цикл відповідно до правил, певними в специфікаціях. Може працювати як повноцінний самостійний веб-сервер, бути постачальником сторінок для іншого веб-сервера, наприклад Apache, або інтегруватися в Java EE сервер додатків. Забезпечує обмін даними між сервлетом і клієнтами, бере на себе виконання таких функцій, як створення програмного середовища для функціонуючого сервлету, ідентифікацію та авторизацію клієнтів, організацію сесії для кожного з них.

Сервер по суті є контейнером, який завантажує сервлети, виконує їх, викликаючи певні методи і отримавши від них результат, відправляє його клієнту.


# Основа сервлета

Архітектура API сервлета грунтується на тому, що класичний провайдер сервісу використовує метод service (), через який всі клієнтські запити будуть надсилатися програмним забезпеченням контейнера сервлетів, і методи життєвого циклу init () і destroy (), які викликаються тільки в той час, коли сервлет завантажується і вивантажується (це трапляється рідко).

```
public interface Servlet {
   public void init(ServletConfig config) throws ServletException;
   
   public ServletConfig getServletConfig();
   
   public void service(ServletRequest req, ServletResponse res)
         throws ServletException, IOException;
   
   public String getServletInfo();
   
   public void destroy();
}
```

Основне призначення getServletConfig () полягає в поверненні об'єкта ServletConfig, який містить параметри ініціалізації і запуску для цього сервлета. getServletInfo () повертає рядок, що містить інформацію про Сервлет, таку, як автор, версія і авторські права.

Клас GenericServlet є оболочечной реалізацією цього інтерфейсу і зазвичай не використовується. Клас HttpServlet є розширенням GenericServlet і спеціально призначений для обробки HTTP протоколу - HttpServelt є одним з тих класів, які ви будете використовувати найчастіше.

Найбільше зручність атрибутів сервлетного API полягає у зовнішніх об'єктах, які вводяться разом з класом HttpServlet для його підтримки. Якщо ви взглянене на метод service () в інтерфейсі Servlet, ви побачите, що він має два параметри: ServeltRequest і ServletResponse. Разом з класом HttpServlet, ці два об'єкти призначені для HTTP: HttpServletRequest і HttpServletResponse.

# Servlet - клас

Сервлет - це Java-клас, який успадковується зазвичай від класу • HttpServlet і перевизначає частину методів:
- doGet - якщо ми хочемо, щоб сервлет реагував на GET запит.
- doPost - якщо ми хочемо, щоб сервлет реагував на POST запит.
- doPut, doDelete - якщо ми хочемо, щоб сервлет реагував на PUT і DELETE запит (є і такі в HTTP). Ці методи реалізуються вкрай рідко, тому що самі команди теж дуже рідко зустрічаються.
- init, destroy - для управління ресурсами в момент створення сервлету і в момент його знищення.

Якщо ж необхідно перехоплювати всі команди, то простіше перевизначити метод service. Саме цей метод викликається при приході запиту від клієнта. У HttpServlet відбувається розбір запиту і у відповідності з вказаною командою викликається метод doGet, doPost і т.д.

# Життєвий цикл сервлета

Життєвий цикл будь-якого сервлета складається з 4 етапів:
- Ініціалізація, яка відбувається при виклику методу init ()
- Обробка клієнтського запиту після виклику методу service ()
- Знищення сервлету за допомогою виклику методу destroy ()
- Повне знищення сервлету (Garbage Collector).

Схематично, життєвий цикл сервлета можна представити таким чином:
![](resources/img/servlet-img-1.jpg)

Після отримання запиту, для обробки якого необхідний певний сервлет, відбувається його ініціалізація (метод init ()). Після цього, відбувається обробка даного запиту (service ()). І, в кінці життєвого циклу сервлету відбувається виклик методу destroy ().


## Метод init()

Даний метод викликається тільки один раз при створенні сервлету.

Зазвичай, створення відбувається в момент переходу за посиланням (URL) на сторінку, роботу якої забезпечує певний сервлет. Це може бути змінено - і створення може відбуватися при запуску сервера.

Після створення сервлету, кожен запит від клієнта призводить до створення нового потоку, який працює з методами doGet або doPost - в залежності від самого запиту.

## Метод service()

Даний метод є основним методом, який і містить саму логіку роботи сервлета. Він викликається для обробки отриманого запиту і передачі відповіді HTTP клієнту.

При отриманні запиту, сервер створює новий потік, який викликає метод service. Даний метод перевіряє тип запиту (POST, GET і т.д.) і викликає відповідний метод (doPost, doGet і т.д.)

## Метод destroy()

Даний метод викликається після того, як сервлет виконав свої завдання. Використовується, наприклад, для таких завдань, як запис даних в cookie, закриття з'єднання до бази даних (далі - БД) і т.д.

# Створення і виконання сревлетів в середовищі Eclipse з використанням maven

# Домашнє завдання

## Варіанти

# Контрольні питання